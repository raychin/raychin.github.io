(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{167:function(e,t,a){"use strict";a.r(t);var r=a(179);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);var o=a(19),u=Object(o.a)(r.default,void 0,void 0,!1,null,null,null);u.options.__file="src/pages/map/components/buildLayer.vue",t.default=u.exports},179:function(e,t,a){"use strict";a.r(t);var r=a(180),n=a.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t.default=n.a},180:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n,o=h(a(73)),u=h(a(181)),i=h(a(182)),s=h(a(174)),l=h(a(191)),c=h(a(192)),d=a(193),f=a(194),p=a(175);function h(e){return e&&e.__esModule?e:{default:e}}t.default={name:"buildLayer",mixins:[d.getMap,f.dataMixins],props:{showMinZoom:{type:Number,default:17},defaultLineSymbol:{type:Object,default:function(){return{"line-color":"#1E90FF","line-width":3}}},defaultSymbol:{type:Object,default:function(){return{"fill-outline-color":"#34495e","fill-color":["case",["has","hasCollect"],["to-color","rgb(176,196,222)"],["to-color","rgb(135,206,250)"]],"fill-opacity":.6}}}},mounted:function(){this.layer=this.initLayer(),this.addViewChange()},methods:{initLayer:function(){var e="buildLayer";return this.map.getLayer(e)||(this.map.addSource(e+"Source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:e+"-line",type:"line",source:e+"Source",layout:{},paint:(0,s.default)({},this.defaultLineSymbol)}),this.map.addLayer({id:e,type:"fill",source:e+"Source",layout:{},paint:(0,s.default)({},this.defaultSymbol)})),this.map.getLayer(e)},addViewChange:function(){var e=this;this.map.on("moveend",(0,i.default)(u.default.mark((function t(){var a,r;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.map.getZoom()>=e.$props.showMinZoom)){t.next=8;break}return t.next=4,e.getBuildData();case 4:(a=t.sent)&&a.length&&(r=e.geojsonToGeo(a),e.renderGeo(r,!1)),t.next=9;break;case 8:e.clear();case 9:case"end":return t.stop()}}),t,e)}))))},addLayerClick:function(){var e=this;this.map.on("click","buildLayer",(function(t){e.$emit("click",t)}))},getBuildData:(n=(0,i.default)(u.default.mark((function e(){var t,a,r,n,i,s,d,f,h;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.map.getBounds(),a=[[t.getWest(),t.getNorth()],[t.getEast(),t.getSouth()]],r=c.default.getViewAreaByBuilding,n=r.url,i=r.request_type,e.prev=3,e.next=6,l.default.Ajax(""+p.blockUrl+n,{request_type:i,paramCodeList:"KJ5003",coordinates:(0,o.default)(a)});case 6:if(s=e.sent,d=s.data,f=d.retCode,h=d.data,"00000"!==f){e.next=12;break}return e.abrupt("return",h.list);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),this.clear();case 17:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(){return n.apply(this,arguments)}),houseStatus:(r=(0,i.default)(u.default.mark((function e(t){var a,r,n,o,i,s,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=[],r=t,n="",o=0;o<r.length;o++)n+=(0===o?"":",")+r[o].areacode;return i={houseid:n},e.next=7,this.request.postNoLoading("collect:houseStatus",i);case 7:if(!(s=e.sent)||200!=s.code){e.next=11;break}for(l=0;l<r.length;l++)(s.data[r[l].areacode]||"0"===s.data[r[l].areacode])&&(r[l].hasCollect="1"),a.push(r[l]);return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)}),clear:function(){this.map.getSource(this.layer.id+"Source").setData({type:"FeatureCollection",features:[]})}}}}}]);