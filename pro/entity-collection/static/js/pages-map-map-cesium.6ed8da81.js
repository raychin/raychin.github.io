(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-map-map-cesium"],{"0261":function(e,t,a){"use strict";a.r(t);var i=a("10e4"),o=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=o.a},"10e4":function(e,t,a){"use strict";var i=a("4ea4");a("99af"),a("4de4"),a("4160"),a("fb6a"),a("a434"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("841c"),a("159b"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(a("5530"));a("96cf");var n=i(a("1da1")),r=a("6946"),s=a("1c61");a("b9fe");var c,l,d,u,p,h,f=i(a("8d81")),g=a("2f62"),m=a("1924"),b=i(a("d040")),v=(i(a("34dd")),i(a("48d0"))),w=i(a("df0e")),y=i(a("53d0")),k=(i(a("e143")),i(a("0bc5")),a("972a")),x=(a("8760"),null),C=!0,L=!0,S=[],D={type:"FeatureCollection",features:[]},T={type:"FeatureCollection",features:[]},$=(S=[],[]),M="",P={name:"building-map",components:{UniSearchBar:s.UniSearchBar,YyhBuilding:r.YyhBuilding},data:function(){return{positionImg:"/static/assets/imgs/icon/map-position.png",drawerVisible:!1,scanImg:"/static/assets/image/imgs/scan.png",timestamp:(new Date).getTime(),areacode:"440309",areaname:"光明区",parentcode:"4403",parentname:"深圳市",FeatureCollection:{type:"FeatureCollection",features:[]},moveend:!1,zoomChange:!1,isClick:!1,isMove:!1,search:!1,searchValue:"",selectValue:"",searchState:!1,searchReturn:{},bulidingList:[],bulidingListShow:!1,bottomTitle:"",bottomCon:"",isShowRouter:!1,queryParams:{},blockToken:"",areaInfo:[],isClickBuildingOnly:!0,dataToken:"",buildingList:[],buildingLevelList:[],cesiumType:"",cesiumJson:[{name:"画点",type:"Point",icon:"/static/imgs/map/icon_map_cesium_point.png"},{name:"画线",type:"LineString",icon:"/static/imgs/map/icon_map_cesium_line.png"},{name:"画面",type:"Polygon",icon:"/static/imgs/map/icon_map_cesium_polygon.png"},{name:"清除",type:"clear",icon:"/static/imgs/map/icon_map_cesium_clear.png"}]}},onShow:function(){this.areaInfo=this.$store.state.areaInfo,this.areaInfo.forEach((function(e,t){}))},mounted:function(){var e=this;return(0,n.default)(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="18672343372",t.next=3,e.ksjGetLoginTokenGM(a);case 3:return i=t.sent,t.next=6,e.ksjGetTokenGM(a,i.data);case 6:t.sent,e.mapInit();case 8:case"end":return t.stop()}}),t)})))()},created:function(){var e=this;uni.$on("updateBuildingInfo",(function(t){e.buildingInfo={},Object.keys(t).length>0&&(e.buildingInfo=JSON.parse(t))}))},watch:{areacode:function(e){},areaInfo:function(e,t){},showCovered:function(e){e&&this.changAreaCodeEvent(this.areacode)},showMarkerByMap:function(e){e&&this.drawInAreaLayer(440309)},newValue:function(e,t){console.log(e),console.log(t),this.bulidingList=[],e!==t&&e!==this.selectValue&&(this.bulidingList=[],e?this.searchAddr(e):(this.bulidingListShow=!1,this.isShowRouter=!1,this.bulidingList=[],console.log(this.bulidingListShow)))}},computed:(0,o.default)({newValue:function(){return this.searchValue}},(0,g.mapState)(["showCovered","showMarkerByMap"]),{pageType:function(){return this.$route.query.pageType?this.$route.query.pageType:0},chooseRoom:function(){return this.$route.query.chooseRoom?this.$route.query.chooseRoom:1}}),methods:{makeCoordinates:function(e){var t=[];if(e.features&&e.features.length>0){var a=e.features[0];"Point"==a.geometry.type?t.push(a.geometry.coordinates):"LineString"==a.geometry.type&&e.features.forEach((function(e){t.push(e.geometry.coordinates)}))}else e.geometry&&"Polygon"==e.geometry.type&&t.push(e.geometry.coordinates);return t},ksjTotalByCoordinates:function(e){var t=this;return new Promise((function(a,i){t.$api.getTotalByCoordinatesBlockCommon(t.dataToken,JSON.stringify(e)).then((function(e){e.success?a(e):i()}))}))},cesiumClick:function(){var e=this,t="";if(d.getSource("line-area")?(t=d.getSource("line-area")._data,console.log("line-area = ",d.getSource("line-area")._data)):d.getSource("line")?(t=d.getSource("line")._data,console.log("line = ",d.getSource("line")._data)):d.getSource("points")&&(t=d.getSource("points")._data,console.log("points = ",d.getSource("points")._data)),t&&Object.keys(t).length>0){var a=t;e.$store.state.mapCesium&&e.$store.state.mapCesium.formId&&(a.formId=e.$store.state.mapCesium.formId),this.$store.commit("updateMapCesium",a),console.log("updateMapCesium = ",a),console.log("updateMapCesium = ",JSON.stringify(a)),uni.navigateBack({delta:1})}else uni.showToast({title:"没有绘制内容",icon:"none"})},drew:function(e,t,a){var i=this;if(i.cesiumType=JSON.parse(JSON.stringify(e)),i.index=a,C=!0,i.clearLayerAndSource(),"clear"!=t)switch(d.getCanvas().style.cursor="crosshair",d.doubleClickZoom.disable(),t){case"Point":M=d.getSource("points"),M?d.getSource("points").setData(D):(d.addSource("points",{type:"geojson",data:D}),d.addLayer({id:"points",type:"circle",source:"points",paint:{"circle-color":"#ffffff","circle-radius":3,"circle-stroke-width":2,"circle-stroke-color":"#ff0000"}}));break;case"LineString":M=d.getSource("points");var o=d.getSource("line-move"),n=d.getSource("line");M?(d.getSource("points").setData(D),o&&d.getSource("line-move").setData(T),n&&d.getSource("line").setData(T)):(d.addSource("points",{type:"geojson",data:D}),d.addSource("line",{type:"geojson",data:T}),d.addSource("line-move",{type:"geojson",data:T}),d.addLayer({id:"line-move",type:"line",source:"line-move",paint:{"line-color":"#ff0000","line-width":2,"line-opacity":.65}}),d.addLayer({id:"line",type:"line",source:"line",paint:{"line-color":"#ff0000","line-width":2,"line-opacity":.65}}),d.addLayer({id:"points",type:"circle",source:"points",paint:{"circle-color":"#ffffff","circle-radius":3,"circle-stroke-width":2,"circle-stroke-color":"#ff0000"}}));break;case"Polygon":M=d.getSource("points-area"),M?(d.getSource("points-area").setData(D),d.getSource("line-area").setData(T)):(d.addSource("points-area",{type:"geojson",data:D}),d.addSource("line-area",{type:"geojson",data:T}),d.addLayer({id:"line-area",type:"fill",source:"line-area",paint:{"fill-color":"#ff0000","fill-opacity":.1}}),d.addLayer({id:"line-area-stroke",type:"line",source:"line-area",paint:{"line-color":"#ff0000","line-width":2,"line-opacity":.65}}),d.addLayer({id:"points-area",type:"circle",source:"points-area",paint:{"circle-color":"#ffffff","circle-radius":3,"circle-stroke-width":2,"circle-stroke-color":"#ff0000"}}));break}},clearLayerAndSource:function(){S&&S.length>0&&(S=[]),$&&$.length>0&&($=[]),D&&D.features&&(D.features=[]),T&&T.features&&(T.features=[]),d.getLayer("circle")&&d.removeLayer("circle"),d.getSource("circle")&&d.removeSource("circle"),d.getLayer("points")&&d.removeLayer("points"),d.getSource("points")&&d.removeSource("points"),d.getLayer("line")&&d.removeLayer("line"),d.getSource("line")&&d.removeSource("line"),d.getLayer("polygon")&&d.removeLayer("polygon"),d.getSource("polygon")&&d.removeSource("polygon"),d.getLayer("rectangle")&&d.removeLayer("rectangle"),d.getSource("rectangle")&&d.removeSource("rectangle"),d.getLayer("line-move")&&d.removeLayer("line-move"),d.getSource("line-move")&&d.removeSource("line-move"),d.getLayer("points-area")&&d.removeLayer("points-area"),d.getSource("points-area")&&d.removeSource("points-area"),d.getLayer("line-area-stroke")&&d.removeLayer("line-area-stroke"),d.getSource("line-area-stroke")&&d.removeSource("line-area-stroke"),d.getLayer("line-area")&&d.removeLayer("line-area"),d.getSource("line-area")&&d.removeSource("line-area")},toBuilding:function(e){"0"!=this.chooseRoom?uni.navigateTo({url:"../choose-room/choose-room"}):uni.navigateBack({delta:1})},ksjGetToken:function(){var e=this;return new Promise((function(t,a){e.$api.ksjGetToken({accessToken:e.$store.state.loginData.accessToken}).then((function(a){a.success?(e.dataToken=a.data.token,e.$store.commit("updateDataToken",a.data.token),t(!0)):t(!1)}))}))},ksjGetLoginTokenGM:function(e){var t=this;return new Promise((function(a,i){t.$api.ksjGetLoginTokenGM({digest:(0,f.default)(e),data:e}).then((function(e){e.success?a(e):i()}))}))},ksjGetTokenGM:function(e,t){var a=this;return new Promise((function(i,o){a.$api.ksjGetTokenGM({digest:(0,f.default)(e),data:t}).then((function(e){e.success?(a.dataToken=e.data.tokenValue,a.$store.commit("updateDataToken",e.data.tokenValue),i(!0)):o()}))}))},toPositionReal:function(e){var t=this;t.currentLon="113.93133505087422",t.currentLat="22.75179694257504",t.toPositionRealFinal(e)},toPositionRealFinal:function(e){var t=this,a=this;p||(p=new w.default(d)),console.log(!e),setTimeout((function(){!e&&t.$store.state.mapCesium?a.initCesiumData():d.setCenter(new GeoGlobe.LngLat(t.currentLon,t.currentLat),16.1),d.setZoom(16.1),p.setImagePoint(t.currentLon,t.currentLat,"location")}),1e3)},initCesiumData:function(){var e=this,t=JSON.parse(JSON.stringify(e.$store.state.mapCesium)),a="",i="";if(t.features&&t.features.length>0){var o=t.features[0];"Point"==o.geometry.type?(a=e.cesiumJson.filter((function(e){return"Point"==e.type}))[0],e.drew(a,a.type,1),D=t,d.getSource("points").setData(D),i=o.geometry.coordinates):"LineString"==o.geometry.type&&(a=e.cesiumJson.filter((function(e){return"LineString"==e.type}))[0],e.drew(a,a.type,1),T=t,D.features=[],t.features.forEach((function(e){e.geometry.coordinates.forEach((function(e){i||(i=e),D.features.push({type:"Feature",geometry:{type:"Point",coordinates:e}})}))})),d.getSource("line").setData(T),d.getSource("points").setData(D))}else if(t.geometry&&"Polygon"==t.geometry.type){a=e.cesiumJson.filter((function(e){return"Polygon"==e.type}))[0],e.drew(a,a.type,1);var n=t;D.features=[],console.log(t),t.geometry.coordinates.forEach((function(e){e.forEach((function(e){i||(i=e),D.features.push({type:"Feature",geometry:{type:"Point",coordinates:e}})}))})),d.getSource("line-area").setData(n),d.getSource("points-area").setData(D)}i&&d.setCenter(new GeoGlobe.LngLat(i[0],i[1]),16.1)},back:function(e){uni.navigateBack(e)},toReset:function(){this.drawAreaLayer(440309),this.drawInAreaLayer(440309),d.flyTo({center:[113.93133505087422,22.75179694257504],zoom:10}),this.isShowRouter=!1,this.$refs.drawer.close()},toConfirm:function(){this.$refs.regionalTree.saveData(),this.$refs.drawer.close()},getFiltrate:function(){this.$refs.drawer.open()},searchInput:function(e){this.searchValue=e},clickPoint:function(e){if(L){console.log("_e = ",e),D.features=[],d.getCanvas().style.cursor="grab";var t=[e.lngLat.lng,e.lngLat.lat];D.features.push({type:"Feature",geometry:{type:"Point",coordinates:t}}),d.getSource("points").setData(D)}},dblclickPoint:function(e){},addLinePoint:function(e){if(D.features.length>0){var t=D.features[D.features.length-1];T.features.push({type:"Feature",geometry:{type:"LineString",coordinates:[t.geometry.coordinates,e]}}),d.getSource("line").setData(T)}D.features.push({type:"Feature",geometry:{type:"Point",coordinates:e}}),d.getSource("points").setData(D)},clickLine:function(e){var t=this;if(C){var a=[e.lngLat.lng,e.lngLat.lat];t.addLinePoint(a)}},mouseMoveLine:function(e){if(C){var t=[e.lngLat.lng,e.lngLat.lat];if(D.features.length>0){var a=D.features[D.features.length-1],i={type:"Feature",geometry:{type:"LineString",coordinates:[a.geometry.coordinates,t]}};d.getSource("line-move").setData(i)}}},dblclickLine:function(e){var t=this;if(C){var a=[e.lngLat.lng,e.lngLat.lat];t.addLinePoint(a),C=!1,d.getCanvas().style.cursor="grab"}},addPolygonPoint:function(e){D.features.push({type:"Feature",geometry:{type:"Point",coordinates:e}}),d.getSource("points-area").setData(D)},clickPolygon:function(e){var t=this;if(C){var a=[e.lngLat.lng,e.lngLat.lat];S.push(a),t.addPolygonPoint(a)}},dblclickPolygon:function(e){if(C){var t=[e.lngLat.lng,e.lngLat.lat];S.push(t),C=!1,d.getCanvas().style.cursor="grab"}},mouseMovePolygon:function(e){if(C){var t=[e.lngLat.lng,e.lngLat.lat],a=D.features.length;if(0!=a&&1!=a){$=S.concat([t]),$=$.concat([S[0]]);var i={type:"Feature",geometry:{type:"Polygon",coordinates:[$]}};d.getSource("line-area").setData(i)}}},mapInit:function(){d=new GeoGlobe.Map({mapCRS:{topTileExtent:[-180,-270,180,90],coordtransform:"none",epsg:4490,isIntScrollZoom:!0},style:m.style,container:"map",zoom:10,minZoom:10,maxZoom:24,units:"degrees",center:[113.93133505087422,22.75179694257504],pitch3Dzoom:18}),d.addControl(new mapboxgl.NavigationControl({showCompass:!0,showZoom:!0}),"bottom-right"),this.mapFunCom()},mapFunCom:function(){var e=this;l=new y.default,c=new b.default(d),u=new v.default(d),p=new w.default(d),h=new w.default(d),d.on("load",(function(){d.touchZoomRotate.disableRotation(),Promise.all([c.addSourceAndLayer(),h.addImagePoint(null,null)]).then((function(t){e.drawAreaLayer(440309),e.drawInAreaLayer(440309)}))})),this.mapMouseEvent(d),this.mapMoveendEvent(d),this.mapZoomEvent(d),this.mapClickEvent(d),this.mapDblClickEvent(d),this.toPositionReal()},mapChangeEvent:function(){var e=d.getZoom(),t=d.getCenter();t.lng,t.lat;if(console.log("Zoom",e),e<=10)"1";else if(e>=10&&e<13)"2";else if(e>=13&&e<15){"3";d.getSource("building")}else e>=15&&e<16?"4":e>=16&&("5",this.getBuildData(this.getBounds()))},itemClick:function(e,t){if(e&&e.areacode){var a;switch(e.areacode.length){case 4:a=10;break;case 6:a=11.5;break;case 9:a=13.5;break;case 12:a=15.5;break;case 15:a=16.5;break}this.drawAreaLayer(e.areacode).then((function(e){e&&d.flyTo({center:[e.lon,e.lat],zoom:a})}))}},mapZoomEvent:function(e){var t=this;e.on("zoomend",(function(){t.mapChangeEvent()}))},mapMoveendEvent:function(e){var t=this;e.on("moveend",(function(e){t.mapChangeEvent()}))},mapMouseEvent:function(e){var t=this,a=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});e.on("mousemove",(function(e){if(t.cesiumType)switch(t.cesiumType.type){case"Point":break;case"LineString":t.mouseMoveLine(e);break;case"Polygon":t.mouseMovePolygon(e);break}})),e.on("mousemove","fillIn_layer",(function(i){var o=e.getZoom();if(t.areacode.length<12&&o<15){var n=i.features[0].properties.areacode;t.lightCode!==n&&(t.lightCode=n,e.setPaintProperty("fillIn_layer","fill-opacity",["match",["get","areacode"],n,.5,0]))}if(12===t.areacode.length){var r=i.lngLat,s=i.features[0].properties.areaname;a.setLngLat(r).setHTML(s).addTo(e)}})),e.on("mouseleave","fillIn_layer",(function(i){t.lightCode="",e.setPaintProperty("fillIn_layer","fill-opacity",0),a.rpxove()}));new mapboxgl.Popup({closeButton:!1,closeOnClick:!1})},mapDblClickEvent:function(e){var t=this;e.on("dblclick",(function(e){if(t.cesiumType)switch(t.cesiumType.type){case"Point":t.dblclickPoint(e);break;case"LineString":t.dblclickLine(e);break;case"Polygon":t.dblclickPolygon(e);break}}))},mapClickEvent:function(e){var t=this;e.on("click",(function(a){if("1"!=t.pageType){var i=e.queryRenderedFeatures(a.point,{layers:["bianjie-highlighted-fills"]});if(console.log("选中区域",i),0!=i.length){if(t.cesiumType)switch(t.cesiumType.type){case"Point":t.clickPoint(a);break;case"LineString":t.clickLine(a);break;case"Polygon":t.clickPolygon(a);break}}else uni.showToast({title:"请在可操作范围内操作!",icon:"none"})}}))},getClickData:function(e,t,a){this.setClickData(e,t,a,!1)},setClickData:function(e,t,a,i){var n=t.lngLat.lng,r=t.lngLat.lat,s=this;if(e.length>0&&this.$store.commit("updateBuildingSource",e[0]),i)e.length>0?this.setClickDataToMap(n,r,!1):this.setClickDataToMap(n,r,!0);else if(console.log("楼栋features",e),console.log("网格features1",a),e.length>0){var c={};c=s.$store.state.mapData?(0,o.default)({},s.$store.state.mapData,{},e[0].properties):(0,o.default)({},e[0].properties),s.$store.commit("updateMapData",c),h||(h=new w.default(d)),this.setClickDataToMap(e[0].properties.LON,e[0].properties.LAT,!1)}else if(a.length&&!this.isClickBuildingOnly){var l={};l=s.$store.state.mapData?(0,o.default)({},s.$store.state.mapData,{},a[0].properties):(0,o.default)({},a[0].properties),s.$store.commit("updateMapData",l),this.setClickDataToMap(e[0].properties.LON,e[0].properties.LAT,!0)}else this.isClickBuildingOnly||uni.showToast({title:"未匹配数据结果!",icon:"none"})},setFilter:function(e){var t=[];return t.push(e[0]),t.push(e[1]),e[2]&&""!==e[2]?t.push(e[2]):t.push("empty"),t},setClickDataToMap:function(e,t,i,o){var n=a("124b");h||(h=new w.default(d)),h.addImagePoint(e,t,n,"clickBuilding"),i?(this.gridSelect=!0,this.filter=this.setFilter(["==","JZWTYDZBM",""])):(this.gridSelect=!1,this.filter=this.setFilter(["==","JZWTYDZBM",this.$store.state.mapData.JZWTYDZBM]),this.queryParams.areacode=this.$store.state.mapData.JZWTYDZBM,this.queryParams.ldmc=this.$store.state.mapData.BZDZ),d.setFilter("build_choose_hover",this.filter),this.setAddressData(e,t,this.$store.state.mapData.BZDZ,o),this.isShowRouter=!0,this.search=!1},drawAreaLayer:function(e){var t=this;return new Promise((function(a,i){var o=!1;t.$api.getAreaInfoByAreaCodeBlockCommon(t.dataToken,e,o).then((function(i){if(i.success&&i.data.list.length>0){var n,r=i.data.list[0],s=(i.data.list[0].areacode,i.data.list[0].parentcode,l.convertFeatureCollection(i.data.list,o)),d=t.$store.state.areaInfo;switch(e.toString().length){case 4:n="city",d=d.slice(0,1);break;case 6:n="region",d=[],d.push({areacode:r.areacode,areaname:r.areaname});break;case 9:n="street",d.splice(1,d.length-1),d.push({areacode:r.areacode,areaname:r.areaname});break;case 12:n="community",d.splice(2,d.length-1),d.push({areacode:r.areacode,areaname:r.areaname});break;case 15:n="grid",d.splice(3,d.length-1),d.push({areacode:r.areacode,areaname:r.areaname});break}console.log(n),t.$store.commit("updateAreaInfo",d),t.areaInfo=t.$store.state.areaInfo,c.setSourceData(n,s),c.setSourceData("bianjie",s),a(r)}else a("")}))}))},drawInAreaLayer:function(e){var t=this;return new Promise((function(a,i){var o=!0;t.$api.getAreaInfoByAreaCodeBlockCommon(t.dataToken,e,o).then((function(i){if(i.success){var n;switch(e.toString().length){case 4:n="region";break;case 6:n="street";break;case 9:n="community";break;case 12:n="grid";break}if(15!==e.toString().length){var r={name:i.data.chirdAreaList.name,code:i.data.chirdAreaList.code};t.$store.commit("updateAreaList",r)}c.setSourceData(n,l.convertFeatureCollection(i.data.chirdAreaInfo,o)),a(!0)}else a(!0)}))}))},clearFeatureCollection:function(e){c.clearSourceData(e)},addMarkerList:function(e,t){if(t.length<=12)for(var a=0;a<e.length;a++){var i=document.createElement("view");1===this.currentLayer?i.className="map_text":i.className="map_text1",i.innerHTML=e[a]._source.areaname;var o=e[a]._source.location.coordinates,n=[0,0];u.addMarker(i,o,n)}},searchAddr:function(e){var t=this;if(this.searchValue){if(console.log(this.$store.state.comToken),!this.$store.state.comToken)return void this.getTokenFZ();this.bulidingListShow=!0,this.searchState=!0;var a=e||this.searchValue,i={param:{token:this.$store.state.comToken,addr:a,limit:100,page:1},url:"/addrMatch/addrApi/searchAddr",method:"GET"};this.$api.addressSearch(i.param).then((function(e){e.success?(t.searchState=!1,e.data&&e.data.addrList&&e.data.addrList.length>0&&(t.searchState=!1,t.bulidingList=e.data.addrList)):t.getTokenFZ(a)}))}},getTokenFZ:function(e){var t=this;this.timestamp=(new Date).getTime();var a={param:{user:k.config.requestUrl.uniformUser,secret:(0,f.default)(this.timestamp+k.config.requestUrl.uniformPassword),time:this.timestamp},url:"/addrMatch/auth/getToken",method:"GET"};this.$api.addressToken(a.param).then((function(a){if(a.success){var i=a.data;i&&i.token&&(t.comToken=i.token,t.$store.commit("updateComToken",i.token),e&&t.searchAddr(e))}}))},goTarget:function(e){if(this.searchReturn=e,console.log(e),e.code&&e.code.length>18)if(this.queryParams.areacode=e.code.substring(0,19),this.search=!0,this.selectValue=e.addr.substring(6),this.bulidingListShow=!1,e.lon){var t=e.lon,a=e.lat;null!==x&&x.rpxove(),d.setCenter(new GeoGlobe.LngLat(t,a),16.5),d.setZoom(16.5),this.isShowRouter=!0}else this.$api.getAreaInfoByAreaCodeBlockCommon(this.dataToken,e.code.substring(0,19),!1).then((function(e){e.success?console.log(e):uni.showToast({title:"无法获取经纬度，定位失败！",icon:"none"})}));else uni.showToast({title:"请选中楼栋",icon:"none"})},searchPlay:function(e){var t=this,a={};a.BZDZ=e.addr,a.JCWGBM=e.wgdm,a.JCWGMC=e.wgmc||"网格名称",a.JDBM=e.jddm,a.JDMC=e.street,a.JZWTYDZBM=e.belong_building,a.CODE=e.code,a.LAT=e.lat,a.LDMC=e.village,a.LON=e.lon,a.QBM=e.qudm,a.QMC=e.district,a.SBM=e.shidm,a.SMC=e.city,a.SQBM=e.sqdm,a.SQMC=e.community;var i={};i=t.$store.state.mapData?(0,o.default)({},t.$store.state.mapData,{},a):(0,o.default)({},a),t.$store.commit("updateMapData",i),console.log(e);var n=e.lon,r=e.lat;this.setClickDataToMap(n,r,!1)},cancelSearch:function(){this.searchValue="",this.searchState=!1,this.bulidingListShow=!1,this.isShowRouter=!1,this.bulidingList=[]},getBuildData:function(e){var t=this;this.$api.getAreaInfoByCoordinatesBlockCommon(this.dataToken,JSON.stringify(e),5).then((function(e){t.useWgData(e.data.list)})),this.$api.getAreaInfoByCoordinatesBlockCommon(this.dataToken,JSON.stringify(e),6).then((function(e){t.showBuild(e.data.list)}))},useWgData:function(e){var t=l.useCodeData(e);t.length>0&&c.setSourceData("grid",t)},showBuild:function(e){var t=l.useCodeData(e);if(t.length>0){var a=JSON.parse(JSON.stringify(this.buildingLevelList));a.length>0&&a.forEach((function(e){for(var a=0;a<t.length;a++)if(e.buildingCode==t[a].properties.JZWTYDZBM){t[a].properties.LEVEL=e.leave,t[a].properties.buildingObject=e;break}})),c.setSourceData("building",t),this.search&&this.searchPlay(this.searchReturn),this.isShowRouter&&(this.filter=this.setFilter(["==","JZWTYDZBM",this.queryParams.areacode]),d.setFilter("build_choose_hover",this.filter))}this.zoomChange=!0},getBounds:function(){return c.getBounds()},btnRouter:function(){var e=this;console.log(this.queryParams),this.$store.state.mapData.CODE&&this.$store.state.mapData.CODE.length>19?uni.navigateTo({url:"./houseDetails?areaCode=".concat(this.$store.state.mapData.CODE)}):window.setTimeout((function(){uni.navigateTo({url:"./buildingDetails?areaCode=".concat(e.$store.state.mapData.JZWTYDZBM)})}),400)},setAddressData:function(e,t,a,i){i?(this.$store.state.mapData.JZWTYDZBM?this.bottomTitle=this.$store.state.mapData.LDMC?this.$store.state.mapData.LDMC:a:this.bottomTitle=this.$store.state.mapData.JCWGMC?this.$store.state.mapData.JCWGMC:a,this.bottomCon=a):this.$store.state.mapData.JZWTYDZBM?(this.bottomTitle=this.$store.state.mapData.LDMC?this.$store.state.mapData.LDMC:a,this.bottomCon=a):(this.bottomTitle=this.$store.state.mapData.JCWGMC,this.bottomCon=a)}}};t.default=P},1631:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 主色 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.map-location[data-v-0ba894a5]{position:absolute;z-index:2;bottom:0;left:0;padding:10px}.map-location uni-image[data-v-0ba894a5]{width:20px;height:20px}.map-location-top uni-image[data-v-0ba894a5]{bottom:96px}.map-wrap[data-v-0ba894a5]{width:100%;height:100%}.map-wrap .drawer[data-v-0ba894a5]{padding:%?5?%}.map-wrap .drawer .filtrate-mask[data-v-0ba894a5]{padding:%?0.15?%}.map-wrap .drawer .filtrate-mask .mask-title[data-v-0ba894a5]{font-size:%?0.14?%;font-weight:400;color:#333;margin:%?0.1?% 0 %?0.1?% 0}.map-wrap .drawer .filtrate-mask .mask-time .mask-time-start[data-v-0ba894a5]{display:-webkit-box;display:-webkit-flex;display:flex;background:#f3f3f3;padding:%?0.1?% %?0.13?%;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-radius:3px}.map-wrap .drawer .filtrate-mask .mask-time .mask-time-start[data-v-0ba894a5]{margin-bottom:%?0.07?%}.map-wrap .drawer .btn-mask-wrap[data-v-0ba894a5]{width:100%;height:%?80?%;position:absolute;left:0}.map-wrap .drawer .btn-mask-wrap .btn-mask[data-v-0ba894a5]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;height:100%;line-height:%?80?%;text-align:center}.map-wrap .drawer .btn-mask-wrap .btn-mask .btn-mask-left[data-v-0ba894a5],\n.map-wrap .drawer .btn-mask-wrap .btn-mask .btn-mask-right[data-v-0ba894a5]{height:100%;width:50%;text-align:center;margin:auto 0;font-size:%?28?%;font-weight:700;color:#666}.map-wrap .drawer .btn-mask-wrap .btn-mask .btn-mask-left[data-v-0ba894a5]{background:#fff}.map-wrap .drawer .btn-mask-wrap .btn-mask .btn-mask-right[data-v-0ba894a5]{background:#4ca4fe;color:#fff}.map-wrap .hd-wrap[data-v-0ba894a5]{position:fixed;width:100%;z-index:2}.map-wrap .hd-wrap-operate[data-v-0ba894a5]{position:fixed;width:100%;z-index:2;top:%?90?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:%?10?% %?200?%}.map-wrap .hd-wrap-operate .hd-wrap-operate-item[data-v-0ba894a5]{padding:%?10?%;border-radius:%?8?%;background-color:#fff;border:#fff %?1?% solid;-webkit-box-align:center;-webkit-align-items:center;align-items:center;text-align:center;font-size:%?26?%;color:#456bdf}.map-wrap .hd-wrap-operate .hd-wrap-operate-item .hd-wrap-operate-item-icon[data-v-0ba894a5]{height:%?48?%;width:%?48?%}.map-wrap .hd-wrap-operate .hd-wrap-operate-item_[data-v-0ba894a5]{background-color:#e1ffff;border:azure %?1?% NaNFFFF}.map-wrap .hd-wrap-select[data-v-0ba894a5]{background:#fff}.map-wrap .bd-wrap[data-v-0ba894a5]{position:absolute;top:0;bottom:0;right:0;left:0;z-index:1;width:100%}.hd-search-wrap .search-all[data-v-0ba894a5]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:0 %?10?%;width:100%;background-color:#fff;height:%?90?%}.hd-search-wrap .search-all .back-css[data-v-0ba894a5]{padding:%?10?% %?15?% %?10?% %?10?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.hd-search-wrap .search-all .back-css .back-icon[data-v-0ba894a5]{width:%?46?%;height:%?46?%}.hd-search-wrap .search-all .title-nav[data-v-0ba894a5]{position:absolute;width:60%;left:20%;z-index:2;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;text-align:center;height:%?100?%;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#333;font-size:%?34?%;font-weight:700;text-align:center;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.hd-search-wrap .search-all .all-left[data-v-0ba894a5]{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background-color:#fff}.hd-search-wrap .search-all .all-left .search-input[data-v-0ba894a5]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.hd-search-wrap .search-all .all-left[data-v-0ba894a5] .uni-searchbar__cancel{font-size:%?30?%}.hd-search-wrap .search-all .search-all-left[data-v-0ba894a5]{-webkit-box-flex:1;-webkit-flex:1;flex:1;padding:0;font-size:%?28?%;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.hd-search-wrap .search-all .search-all-img[data-v-0ba894a5]{width:%?42?%;height:%?42?%;margin-left:%?28?%}.hd-search-wrap .search-all[data-v-0ba894a5] .uni-searchbar{background-color:initial}.map-all[data-v-0ba894a5]{position:absolute;top:0;bottom:0;right:0;left:0;overflow:hidden}.map-all .map-container[data-v-0ba894a5]{height:100%}.map-all[data-v-0ba894a5] .mapboxgl-ctrl-attrib.mapboxgl-compact{display:none}.map_text[data-v-0ba894a5]{font-size:50px;color:red}.map_text1[data-v-0ba894a5]{font-size:50px;color:red}.search-list[data-v-0ba894a5]{width:100%;max-height:%?800?%;background:#fff;position:absolute;top:100%;left:0;overflow:auto;border-bottom-left-radius:10px;border-bottom-right-radius:10px;box-shadow:0 2px 2px #ccc}.search-status[data-v-0ba894a5]{text-align:center;font-size:%?26?%;line-height:%?200?%}.search-item[data-v-0ba894a5]{border-bottom:1px solid #eee;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:%?20?%}.search-item .left[data-v-0ba894a5]{width:%?50?%}.search-item .left uni-image[data-v-0ba894a5]{width:%?40?%;height:%?40?%}.search-item .right[data-v-0ba894a5]{-webkit-box-flex:1;-webkit-flex:1;flex:1;margin-left:%?10?%}.search-item .right h3[data-v-0ba894a5]{font-size:%?24?%;font-weight:400;color:#333}.search-item .right p[data-v-0ba894a5]{margin-top:%?6?%;font-size:%?12?%;color:#666}.search-item:last-child .right[data-v-0ba894a5]{border-bottom:none}.map[data-v-0ba894a5]{width:375px;height:100vh;position:relative}.map .fixed[data-v-0ba894a5]{background:#fff;border-radius:50%;position:absolute;right:%?0.2?%;bottom:%?2.8?%;z-index:100;width:%?0.8?%;height:%?0.8?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;box-shadow:0 0 4px #ccc}.map .fixed img[data-v-0ba894a5]{width:%?0.6?%;height:%?0.6?%;margin:0 auto}.left-view[data-v-0ba894a5]{width:35%;left:%?50?%;top:%?150?%;position:absolute;background:#fff;z-index:999}.left-view[data-v-0ba894a5] .uni-collapse-cell{border-color:#fff}.bottom-sure[data-v-0ba894a5]{background-color:#1e90ff;width:70%;bottom:%?20?%;left:15%;position:absolute;z-index:999;padding:%?20?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;font-size:%?32?%;color:#fff;border-radius:%?10?%}.bottom[data-v-0ba894a5]{background-color:#fff;width:100%;bottom:0;position:absolute;z-index:999;padding:%?30?%;border-top-left-radius:10px;border-top-right-radius:10px;box-shadow:0 0 2px #ccc}.bottom2[data-v-0ba894a5]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-bottom:%?0.1?%}.bottom_router[data-v-0ba894a5]{background:#4ca4fe;height:%?100?%;width:%?100?%;line-height:%?100?%;\n  /*padding: 0.04rpx ;*/border-radius:50%;\n  /*width: 100%;*/right:%?20?%;top:%?-40?%;position:absolute;z-index:999;text-align:center;color:#fff;font-size:%?30?%;box-shadow:0 0 2px #4ca4fe}',""]),e.exports=t},7860:function(e,t,a){"use strict";a.r(t);var i=a("aa41"),o=a("0261");for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);a("faf1");var r,s=a("f0c5"),c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"0ba894a5",null,!1,i["a"],r);t["default"]=c.exports},8835:function(e,t,a){var i=a("1631");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=a("4f06").default;o("0b197a79",i,!0,{sourceMap:!1,shadowMode:!1})},aa41:function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"map-wrap"},[a("v-uni-view",{staticClass:"hd-wrap",class:{"hd-wrap-select":e.searchValue}},[a("header",{staticClass:"hd-box"},[a("v-uni-view",{staticClass:"hd-search-wrap"},[a("v-uni-view",{staticClass:"search-all"},[a("v-uni-view",{staticClass:"back-css",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.back(1)}}},[a("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/imgs/icon/back.png"}})],1),a("v-uni-view",{staticClass:"title-nav"},[e._v("地图绘制")])],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.bulidingListShow,expression:"bulidingListShow"}],staticClass:"search-list"},[e.searchState?a("v-uni-view",{staticClass:"search-status"},[e._v("搜索中...")]):e._e(),e.bulidingList.length||e.searchState||""==e.searchValue?e._l(e.bulidingList,(function(t,i){return a("v-uni-view",{key:"bulidingList"+i,staticClass:"search-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.goTarget(t)}}},[a("v-uni-view",{staticClass:"left"},[a("v-uni-image",{attrs:{src:"/static/imgs/icon/location1.png"}})],1),a("v-uni-view",{staticClass:"right"},[a("h3",{staticStyle:{"font-size":"30rpx"}},[e._v(e._s(t.addr.substring(6)))]),a("p",{staticStyle:{"font-size":"28rpx"}},[e._v(e._s(t.code))])])],1)})):a("v-uni-view",{staticClass:"search-status"},[e._v("未查询到地址")])],2)],1)],1)]),"0"==e.pageType?a("v-uni-view",{staticClass:"hd-wrap-operate"},e._l(e.cesiumJson,(function(t,i){return a("v-uni-view",{key:"op"+i,staticClass:"hd-wrap-operate-item",class:[{"hd-wrap-operate-item_":e.cesiumType&&t.type==e.cesiumType.type}],on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.drew(t,t.type,1)}}},[a("v-uni-image",{staticClass:"hd-wrap-operate-item-icon",attrs:{src:t.icon}})],1)})),1):e._e(),a("v-uni-view",{staticClass:"bd-wrap"},[a("v-uni-view",{staticClass:"map-all"},[a("v-uni-view",{staticClass:"map-container",staticStyle:{background:"#C0D7F8"},attrs:{id:"map"}}),"0"==e.pageType?a("v-uni-view",{staticClass:"bottom-sure",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cesiumClick.apply(void 0,arguments)}}},[e._v("确定")]):e._e(),e._e()],1),e._e()],1)],1)},n=[]},faf1:function(e,t,a){"use strict";var i=a("8835"),o=a.n(i);o.a}}]);